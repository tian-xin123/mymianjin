import{t as e}from"./request-_JOEXu8t.js";import{C as t,D as n,E as r,O as i,S as a,T as o,_ as s,b as c,c as l,g as u,h as d,j as f,k as p,n as m,p as h,s as g,t as _,v,w as y}from"./index-EUzX2dG9.js";import{t as b}from"./ArticleItem-F34Z6R-M.js";function x(t){return e.get(`/h5/interview/query`,{headers:{Authorization:m()},params:t})}var S={class:`home-view`},C={class:`my-nav van-hairline--bottom`},w={class:`article-list`},T={class:`load-more`},E={key:1,class:`no-more`},D=g(a({__name:`HomeView`,setup(e){let a=p([]),m=p([]),g=p(!1),D=p(1),O=p(10),k=p(0),A=p(!1),j=p(!1),M=(e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime(),N=()=>[...a.value].sort(M),P=e=>{g.value=e,g.value?m.value=N():m.value=[...a.value]},F=async()=>{try{D.value=1,A.value=!0,j.value=!1;let e=await x({current:D.value,pageSize:O.value});a.value=e.data.data.rows,k.value=e.data.data.total,m.value=[...a.value],a.value.length>=k.value&&(j.value=!0)}catch(e){l(`获取数据失败，请稍后重试`),console.error(`获取数据失败:`,e)}finally{A.value=!1}};t(async()=>{await F(),window.addEventListener(`scroll`,I)}),y(()=>{window.removeEventListener(`scroll`,I)});let I=()=>{let e=document.documentElement.scrollTop||document.body.scrollTop,t=document.documentElement.clientHeight||window.innerHeight,n=document.documentElement.scrollHeight||document.body.scrollHeight;e+t>=n-200&&!A.value&&!j.value&&L()},L=async()=>{if(!(A.value||j.value))try{A.value=!0,D.value++;let e=await x({current:D.value,pageSize:O.value}),t=e.data.data.rows;k.value=e.data.data.total,a.value.push(...t),g.value?m.value=N():m.value=[...a.value],a.value.length>=k.value&&(j.value=!0)}catch(e){l(`加载更多失败，请稍后重试`),console.error(`加载更多失败:`,e),D.value--}finally{A.value=!1}},R=e=>{_.push({name:`article`,params:{id:e}})};return(e,t)=>{let a=n(`van-loading`);return o(),v(`div`,S,[d(`nav`,C,[d(`a`,{class:f({active:!g.value}),href:`javascript:;`,onClick:t[0]||=e=>P(!1)},`推荐`,2),d(`a`,{class:f({active:g.value}),href:`javascript:;`,onClick:t[1]||=e=>P(!0)},`最新`,2),t[2]||=d(`div`,{class:`logo`},[d(`h1`,{class:`logo-text`},`面经`)],-1)]),d(`div`,w,[(o(!0),v(h,null,r(m.value,e=>(o(),u(b,{key:e.id,item:e,onClick:t=>R(e.id)},null,8,[`item`,`onClick`]))),128))]),d(`div`,T,[A.value?(o(),u(a,{key:0,size:`20px`,color:`#999`,vertical:``},{default:i(()=>[...t[3]||=[c(` 加载中... `,-1)]]),_:1})):j.value?(o(),v(`span`,E,`没有更多数据了`)):s(``,!0)])])}}}),[[`__scopeId`,`data-v-3e962864`]]);export{D as default};